import{f as v,r as x,u as p,a as k,b as y,g as C,j as e,X as _,C as L,M as z,F as E,S as $,d as P,B as F,h as B,i as T,H as A,k as M,e as R}from"./index-BnbwrKyu.js";import{P as U,M as O,F as G,G as D,u as I}from"./useFollow-CFd--JB9.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=v("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=v("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),H=()=>{const[o,l]=x.useState(!1),[n,h]=x.useState(null),d=p(c=>{var s;return(s=c==null?void 0:c.auth)==null?void 0:s.user}),m=k();return x.useEffect(()=>{d||(async()=>{var s,a;l(!0);try{const r=await y.get("/auth/profile");m(C(r.data.user))}catch(r){h(((a=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:a.message)||"Something went wronge"),console.error("Error fetching profile:",r)}finally{l(!1)}})()},[]),{loading:o,error:n}};function W({isOpen:o,onClose:l,profileId:n}){console.log(n);const[h,d]=x.useState(!1),m=x.useRef(null);x.useEffect(()=>{const a=r=>{m.current&&!m.current.contains(r.target)&&l()};return o&&document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[o,l]);const c=async()=>{const a=`undefined/seller/${n}`;await navigator.clipboard.writeText(a),d(!0),setTimeout(()=>d(!1),2e3)},s=[{name:"Copy link",icon:e.jsx(L,{className:"w-5 h-5"}),onClick:c},{name:"Share to WhatsApp",icon:e.jsx(z,{className:"w-5 h-5"}),onClick:()=>{const a=encodeURIComponent(`undefined/seller/${n}`);window.open(`https://wa.me/?text=${a}`,"_blank")}},{name:"Share to Facebook",icon:e.jsx(E,{className:"w-5 h-5"}),onClick:()=>{const a=encodeURIComponent(`undefined/seller/${n}`);window.open(`https://www.facebook.com/sharer/sharer.php?u=${a}`,"_blank")}},{name:"Share to Telegram",icon:e.jsx($,{className:"w-5 h-5"}),onClick:()=>{const a=encodeURIComponent(`undefined/seller/${n}`);window.open(`https://t.me/share/url?url=${a}`,"_blank")}}];return o?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{ref:m,className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-sm overflow-hidden",children:[e.jsxs("div",{className:"relative border-b dark:border-gray-700",children:[e.jsx("h3",{className:"text-center py-4 font-semibold dark:text-white",children:"Share to"}),e.jsx("button",{onClick:l,className:"absolute right-4 top-4 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:s.map(a=>e.jsxs("button",{onClick:a.onClick,className:"w-full flex items-center space-x-3 p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:a.icon}),e.jsx("span",{className:"text-sm font-medium dark:text-white",children:a.name})]},a.name))}),h&&e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black text-white px-4 py-2 rounded-full text-sm",children:"Link copied!"})]})}):null}function K(o){const l=o.value,n=o.following,h=o.followers,{loading:d,error:m}=H(),c=P(),[s,a]=x.useState(!0),[r,i]=x.useState(!1),t=p(u=>{var g;return(g=u==null?void 0:u.auth)==null?void 0:g.user}),f=()=>{i(!0)};if(d)return e.jsx(U,{});if(m)return e.jsx(e.Fragment,{children:e.jsx("div",{className:" w-full text-center text-red-500",children:"Sometching went wronge"})});const b=async u=>{c(u)};return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"max-w-screen-lg mx-auto mt-2 sm:mt-5 md:mt-10 px-4",children:e.jsxs("div",{className:"flex flex-row items-center md:items-start gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 md:w-40 md:h-40 rounded-[25%] overflow-hidden",children:e.jsx("img",{src:t==null?void 0:t.profilePicture,alt:"Profile",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"sm:hidden flex items-center justify-start gap-4 ",children:e.jsx("h1",{className:"text font-semibold text-gray-800 dark:text-gray-200",children:t==null?void 0:t.fullName})})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"sm:flex hidden items-center justify-start gap-4 ",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-800 dark:text-gray-200",children:t==null?void 0:t.fullName}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(F,{onClick:()=>b("/messages"),className:"w-6 h-6 text-gray-500 cursor-pointer"}),e.jsx(B,{className:"w-6 h-6 text-green-500 cursor-pointer"}),e.jsx(O,{className:"w-6 h-6 text-blue-500 cursor-pointer"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"flex space-x-2 sm:space-x-4 md:space-x-8 mt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block font-semibold text-gray-800 dark:text-gray-200 text-center",children:l}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium",children:"posts"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-semibold text-gray-800 dark:text-gray-200 text-center",children:h}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium",children:"followers"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-semibold text-gray-800 dark:text-gray-200 text-center",children:n}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium",children:"following"})]})]})}),e.jsxs("div",{className:"sm:mt-4 mt-1 bg-gray-300 p-2 rounded-md",children:[e.jsx("h2",{className:"sm:text-lg text-xs capitalize font-semibold text-gray-800 dark:text-gray-200",children:t==null?void 0:t.occupation}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 sm:text-base text-xs",children:[e.jsx("span",{children:"Website @ "}),e.jsx("a",{href:"#",className:"text-blue-500 hover:underline",children:t==null?void 0:t.website})," ","| ",t==null?void 0:t.address]})]})]})]})}),e.jsxs("div",{className:"sm:mt-4 mt-2 flex gap-4 flex-grow",children:[e.jsx("button",{onClick:()=>c("/editProfile"),className:" flex-1 px-4 py-1 border rounded-md text-base sm:text-lg font-semibold hover:bg-gray-100 dark:hover:bg-gray-800",children:"Edit Profile"}),e.jsx("button",{onClick:f,className:"flex-1 px-4 py-1 border rounded-md text-base sm:text-lg font-semibold hover:bg-gray-100 dark:hover:bg-gray-800 active:scale-95",children:"Share Profile"})]}),e.jsx(W,{isOpen:r,onClose:()=>i(!1),profileId:t==null?void 0:t._id}),e.jsx("div",{className:"mt-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4",children:e.jsx("div",{className:"relative w-full h-[9.5rem] sm:h-60 md:h-72 lg:h-80 overflow-hidden rounded-lg",children:s?e.jsx("video",{src:"https://cdn.pixabay.com/video/2023/12/03/191860-891640938_large.mp4",autoPlay:!0,loop:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover"}):e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-100 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-all",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center text-gray-500 dark:text-gray-400 mb-2",children:e.jsx(G,{className:"h-12 w-12"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg font-medium",children:"Add Video"})]})})})})})]})}function X(o){console.log(o);const l=P(),n=o.posts,[h,d]=x.useState({}),m=()=>new Promise(s=>{const a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.onload=()=>s(!0),a.onerror=()=>s(!1),document.body.appendChild(a)}),c=async(s,a)=>{var r;s.stopPropagation(),d(i=>({...i,[a]:!0}));try{if(!await m())throw new Error("Failed to load Razorpay script");const t=await y.post("/post/boostPost",{postId:a,amount:500*100});console.log(t);const f={key:"rzp_test_fOsTScdkbhACcC",amount:t==null?void 0:t.data.order.amount,currency:"INR",name:"Boost Post",description:`Boosting post with post-id: ${a}`,order_id:t==null?void 0:t.data.order.id,handler:async u=>{const g=await y.post("/post/boost-post/verify-payment",{razorpay_payment_id:u.razorpay_payment_id,razorpay_order_id:u.razorpay_order_id,razorpay_signature:u.razorpay_signature,postId:a});console.log(g.data.post);const S=g==null?void 0:g.data.post,w=n.findIndex(j=>j._id===g.data.post._id);console.log(w),setPosts(j=>{const N=[...j];return N[w]=S,N})},prefill:{name:"User Name",email:"user@example.com",contact:"9999999999"},theme:{color:"#3B82F6"}};new window.Razorpay(f).open()}catch(i){i!=null&&i.response?(console.log((r=i==null?void 0:i.response)==null?void 0:r.data),alert("Payment verification failed. Please contact support.")):console.log(i)}finally{d(i=>({...i,[a]:!1}))}};return e.jsx(e.Fragment,{children:n?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex justify-center border-t dark:border-gray-700",children:e.jsxs("div",{className:"flex space-x-12",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-4 border-t-2 border-black dark:border-white -mt-px",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"POSTS"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-4 text-gray-500 hover:text-gray-900",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"SAVED"})]})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-1 md:gap-8 mt-4",children:n&&n.length&&n.map(s=>{var a,r,i,t;return e.jsxs("div",{onClick:()=>l(`/reels/${s._id}`),className:"relative aspect-square group",children:[["mp4","webm","mov"].includes((r=(a=s==null?void 0:s.file)==null?void 0:a.fileType)==null?void 0:r.toLowerCase())?e.jsx("video",{src:s.file.url,className:"w-full h-full object-cover",muted:!0}):["jpg","jpeg","png","gif","webp"].includes((t=(i=s==null?void 0:s.file)==null?void 0:i.fileType)==null?void 0:t.toLowerCase())?e.jsx("img",{src:s==null?void 0:s.file.url,alt:(s==null?void 0:s.caption)||"Post Image",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200 text-gray-500",children:"Unsupported Format"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsxs("div",{className:"flex gap-3 sm:gap-6 md:gap-9 text-white",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4 sm:w-6 sm:h-6 fill-current"}),e.jsx("span",{className:"font-semibold",children:s==null?void 0:s.likes})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z"})}),e.jsx("span",{className:"font-semibold",children:(s==null?void 0:s.comments)||0})]})]})}),e.jsx("button",{onClick:f=>c(f,s._id),disabled:s.isBoosted.status,className:`absolute top-2 right-2 p-2 rounded-full shadow-lg transform transition-all duration-300 ease-in-out
              ${s.isBoosted.status?"bg-gradient-to-r from-green-400 to-green-500 cursor-not-allowed scale-105":"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-purple-600 hover:to-blue-500 hover:scale-105"} text-white`,children:h[s==null?void 0:s._id]?e.jsx(V,{className:"animate-spin w-4 h-4"}):s.isBoosted.status?e.jsx("span",{className:"flex items-center space-x-1 px-1 transition-opacity duration-200",children:e.jsx("span",{className:" text-[0.5rem] sm:text-xs font-medium whitespace-nowrap",children:"Boosted"})}):e.jsx(q,{className:"sm:w-5 sm:h-5 w-[0.85rem] h-[0.85rem] animate-pulse"})})]},s._id)})})]}):e.jsx("div",{children:"no post found"})})}const J=()=>{const[o,l]=x.useState(!1),[n,h]=x.useState(),d=k(),m=p(c=>c.auth.posts);return x.useEffect(()=>{m||(async()=>{var s,a;l(!0);try{const r=await y.get("/auth/post");console.log(r.data.posts),d(M(r.data.posts))}catch(r){h(((a=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:a.message)||"Something went wrong"),l(!1)}finally{l(!1)}})()},[]),{loading:o,error:n}},Q=()=>e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex justify-center border-t dark:border-gray-700",children:e.jsx("div",{className:"flex space-x-12",children:["POSTS","SAVED","LIKED"].map((o,l)=>e.jsxs("div",{className:"flex items-center space-x-2 px-4 py-4 animate-pulse",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-700 rounded-full"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded-md w-16"})]},l))})}),e.jsx("div",{className:"grid grid-cols-3 gap-1 md:gap-8 mt-4",children:Array.from({length:9}).map((o,l)=>e.jsxs("div",{className:"relative aspect-square animate-pulse",children:[e.jsx("div",{className:"w-full h-full bg-gray-300 dark:bg-gray-700"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0"})]},l))})]});function ee(){const{isLoggedIn:o}=R();if(!o)return window.location.href="/signup",null;p(a=>{var r;return(r=a==null?void 0:a.auth)==null?void 0:r.user});const{followError:l,followLoading:n,following:h,followers:d}=I(),{loading:m,error:c}=J(),s=p(a=>a.auth.posts||[]);return m||n?e.jsx(Q,{}):e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900",children:[e.jsx(K,{value:s.length||0,following:h.length,followers:d.length})," ",e.jsx(X,{posts:s})]})}export{ee as default};
