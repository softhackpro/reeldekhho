const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Post-DTAMQtJd.js","assets/index-Deeox68m.js","assets/index-UbnnFNqt.css","assets/HeaderStatic-D0uLpqn3.js"])))=>i.map(i=>d[i]);
import{j as e,U as f,r as n,u,a as v,b as p,s as h,c as y,d as b,e as w,f as N,_ as P}from"./index-Deeox68m.js";import{H as S}from"./HeaderStatic-D0uLpqn3.js";function _(){return e.jsx("div",{className:"p-4 sticky top-4",children:e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(f,{className:"w-8 h-8 dark:text-white"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold dark:text-white",children:"Welcome to Reeldekho"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Discover people to follow"})]})]})})})}const k=()=>{const[l,x]=n.useState(!1),[m,c]=n.useState(null),a=u(d=>{var r;return(r=d==null?void 0:d.post)==null?void 0:r.posts}),o=v(),s=u(d=>{var r;return(r=d==null?void 0:d.post)==null?void 0:r.page});let t=[];return n.useEffect(()=>{const d=async()=>{var r,i;console.log("I am run ng fetch post "),x(!0);try{t=a.map(j=>j._id).join(",");const g=await p.get(`/post/get?page=${s}&excludeIds=${t}`);o(h({type:"ADD_POST",payload:g.data.posts}))}catch(g){c(((i=(r=g.response)==null?void 0:r.data)==null?void 0:i.message)||"An error occurred")}finally{x(!1)}};a!=null&&a.length||d()},[]),{loading:l,error:m,posts:a,loadMorePosts:async()=>{var d,r;try{t=a.map(g=>g._id).join(",");const i=await p.get(`/post/get?page=${s}&excludeIds=${t}`);i.data.posts.length>0&&o(h({type:"ADD_POST",payload:i.data.posts}))}catch(i){c(((r=(d=i.response)==null?void 0:d.data)==null?void 0:r.message)||"An error occurred")}}}},I=()=>{const l=v();return{addSavedPost:async a=>{var o,s;try{const t=await p.post("/post/addSaved?postId="+a);console.log(t.data),l(y(t.data.savedPost))}catch(t){console.error((s=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:s.error)}},getSavedPosts:async()=>{var a,o;try{const s=await p.get("/post/getsaved");console.log(s.data),l(b(s.data.savedPosts))}catch(s){console.error(((o=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:o.error)||s)}},removeSavedPost:async a=>{try{console.log(a);const o=await p.delete(`/post/deletesaved?id=${a}`,{data:{postId:a}});console.log(o.data),l(w({_id:a}))}catch(o){console.error(o)}}}},D=n.lazy(()=>P(()=>import("./Post-DTAMQtJd.js"),__vite__mapDeps([0,1,2,3]))),E=()=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"w-full h-14 dark:bg-black bg-white animate-pulse rounded-md mb-2"}),e.jsx("div",{className:"flex max-w-lg h-fit",children:e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[...Array(5)].map((l,x)=>e.jsxs("div",{className:"bg-white dark:bg-black rounded-lg shadow-md p-4 space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-gray-400 w-10 h-10 rounded-full"}),e.jsx("div",{className:"bg-gray-400 h-6 w-24 rounded"})]}),e.jsx("div",{className:"bg-gray-400 w-full h-80 rounded-lg mt-4"}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"space-x-4 flex",children:[e.jsx("div",{className:"bg-gray-400 w-6 h-6 rounded-full"}),e.jsx("div",{className:"bg-gray-400 w-6 h-6 rounded-full"}),e.jsx("div",{className:"bg-gray-400 w-6 h-6 rounded-full"})]}),e.jsx("div",{className:"bg-gray-400 w-12 h-6 rounded"})]}),e.jsx("div",{className:"bg-gray-400 h-6 w-3/4 rounded mt-2"}),e.jsx("div",{className:"bg-gray-400 h-6 w-1/2 rounded mt-1"}),e.jsx("div",{className:"bg-gray-400 h-6 w-2/3 rounded mt-3"}),e.jsx("div",{className:"bg-gray-400 h-6 w-3/4 rounded mt-1"})]},x))})})]});function A(){const{loading:l,error:x,loadMorePosts:m}=k(),c=u(s=>{var t;return(t=s==null?void 0:s.post)==null?void 0:t.posts}),a=N(n.useCallback(()=>{m()},[m]),()=>{},{threshold:.3}),{getSavedPosts:o}=I();return n.useEffect(()=>{o()},[]),l?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsxs("div",{className:"max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-3 margintopo",children:[e.jsxs("div",{className:"lg:col-span-2 mx-auto md:mt-0 max-w-2xl",children:[e.jsx(n.Suspense,{fallback:e.jsx("div",{children:" "}),children:e.jsx("div",{className:" flex flex-col gap-2",children:(c==null?void 0:c.length)>0?c.map((s,t)=>e.jsx(D,{post:s},t)):e.jsx("div",{className:"text-center text-gray-500",children:"No posts available"})})}),e.jsx("div",{className:"w-full dark:text-white text-black text-center mt-3",ref:a,children:"Loading ..."})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(n.Suspense,{fallback:e.jsx("div",{children:"Loading Suggestions..."}),children:e.jsx(_,{})})})]})]})}const F=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{F,I as u};
